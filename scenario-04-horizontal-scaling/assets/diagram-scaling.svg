<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 460" font-family="'Segoe UI', Arial, sans-serif">

  <rect width="800" height="460" fill="#f8f9ff" rx="16"/>
  <text x="400" y="36" text-anchor="middle" font-size="20" font-weight="bold" fill="#1a1a2e">Horizontal Scaling: Before and After</text>

  <defs>
    <marker id="blue-arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#90b4f5"/>
    </marker>
    <marker id="green-arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#4caf50"/>
    </marker>
    <marker id="red-arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#cc3333"/>
    </marker>
    <marker id="orange-arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#e67e22"/>
    </marker>
  </defs>

  <!-- ===== BEFORE ===== -->
  <rect x="20" y="58" width="352" height="340" fill="#fff0f0" rx="12" stroke="#ffcccc" stroke-width="2"/>
  <text x="196" y="84" text-anchor="middle" font-size="15" font-weight="bold" fill="#cc3333">âŒ Before â€” One Server</text>
  <text x="196" y="100" text-anchor="middle" font-size="10" fill="#888">All 20 requests land on one machine</text>

  <!-- Users before -->
  <text x="60" y="125" text-anchor="middle" font-size="20">ğŸ‘¤ğŸ‘¤ğŸ‘¤</text>
  <text x="60" y="143" text-anchor="middle" font-size="9" fill="#888">20 users</text>

  <!-- Arrows to single server -->
  <line x1="88" y1="130" x2="140" y2="175" stroke="#cc3333" stroke-width="1.5" marker-end="url(#red-arrow)"/>
  <line x1="88" y1="133" x2="140" y2="195" stroke="#cc3333" stroke-width="1.5" marker-end="url(#red-arrow)"/>
  <line x1="88" y1="136" x2="140" y2="215" stroke="#cc3333" stroke-width="1.5" marker-end="url(#red-arrow)"/>
  <text x="114" y="163" text-anchor="middle" font-size="9" fill="#cc3333">all of them</text>
  <text x="114" y="175" text-anchor="middle" font-size="9" fill="#cc3333">â†’ one server</text>

  <!-- Single server box -->
  <rect x="142" y="158" width="140" height="145" fill="#ffdddd" rx="8" stroke="#ff8080" stroke-width="2"/>
  <text x="212" y="178" text-anchor="middle" font-size="11" font-weight="bold" fill="#cc3333">ğŸ–¥ï¸ Server</text>

  <!-- CPU bar full -->
  <text x="212" y="198" text-anchor="middle" font-size="9" fill="#555">CPU</text>
  <rect x="158" y="202" width="108" height="12" fill="#e0e0e0" rx="3"/>
  <rect x="158" y="202" width="108" height="12" fill="#cc3333" rx="3"/>
  <text x="212" y="225" text-anchor="middle" font-size="9" font-weight="bold" fill="#cc3333">100% ğŸ”´</text>

  <text x="212" y="245" text-anchor="middle" font-size="9" fill="#555">Requests queue up.</text>
  <text x="212" y="259" text-anchor="middle" font-size="9" fill="#555">Each waits for the one</text>
  <text x="212" y="273" text-anchor="middle" font-size="9" fill="#555">before it to finish.</text>
  <text x="212" y="291" text-anchor="middle" font-size="9" font-weight="bold" fill="#cc3333">p99 latency: ~8,000ms</text>

  <!-- Arrow to DB before -->
  <line x1="284" y1="230" x2="318" y2="230" stroke="#4caf50" stroke-width="1.5" marker-end="url(#green-arrow)"/>

  <!-- DB before -->
  <rect x="320" y="188" width="40" height="60" fill="#d4edda" rx="4" stroke="#4caf50" stroke-width="1.5"/>
  <text x="340" y="212" text-anchor="middle" font-size="9" fill="#1a7a3c">DB</text>
  <text x="340" y="225" text-anchor="middle" font-size="8" fill="#1a7a3c">fine âœ“</text>

  <!-- Result label before -->
  <rect x="36" y="322" width="322" height="62" fill="#ffb3b3" rx="6"/>
  <text x="197" y="340" text-anchor="middle" font-size="11" font-weight="bold" fill="#cc0000">One machine. One CPU. One ceiling.</text>
  <text x="197" y="357" text-anchor="middle" font-size="10" fill="#cc0000">Every request competes for the same processor.</text>
  <text x="197" y="372" text-anchor="middle" font-size="10" fill="#cc0000">No tuning fixes this. You need another machine.</text>

  <!-- ===== AFTER ===== -->
  <rect x="428" y="58" width="352" height="340" fill="#f0fff4" rx="12" stroke="#b3f0c8" stroke-width="2"/>
  <text x="604" y="84" text-anchor="middle" font-size="15" font-weight="bold" fill="#1a7a3c">âœ… After â€” Two Servers</text>
  <text x="604" y="100" text-anchor="middle" font-size="10" fill="#888">Requests distributed across two machines</text>

  <!-- Users after -->
  <text x="466" y="125" text-anchor="middle" font-size="20">ğŸ‘¤ğŸ‘¤ğŸ‘¤</text>
  <text x="466" y="143" text-anchor="middle" font-size="9" fill="#888">20 users</text>

  <!-- Arrow to nginx -->
  <line x1="490" y1="130" x2="536" y2="200" stroke="#4caf50" stroke-width="1.8" marker-end="url(#green-arrow)"/>
  <line x1="490" y1="133" x2="536" y2="207" stroke="#4caf50" stroke-width="1.8" marker-end="url(#green-arrow)"/>
  <line x1="490" y1="136" x2="536" y2="214" stroke="#4caf50" stroke-width="1.8" marker-end="url(#green-arrow)"/>

  <!-- nginx box -->
  <rect x="538" y="188" width="88" height="52" fill="#e8d5ff" rx="8" stroke="#9b59b6" stroke-width="2"/>
  <text x="582" y="208" text-anchor="middle" font-size="11" font-weight="bold" fill="#6c3483">âš–ï¸ nginx</text>
  <text x="582" y="224" text-anchor="middle" font-size="9" fill="#6c3483">round-robin</text>
  <text x="582" y="236" text-anchor="middle" font-size="9" fill="#6c3483">load balancer</text>

  <!-- nginx to app1 -->
  <line x1="628" y1="200" x2="658" y2="170" stroke="#9b59b6" stroke-width="1.5" marker-end="url(#orange-arrow)"/>
  <text x="648" y="183" text-anchor="middle" font-size="8" fill="#9b59b6">req 1,3,5...</text>

  <!-- nginx to app2 -->
  <line x1="628" y1="224" x2="658" y2="254" stroke="#9b59b6" stroke-width="1.5" marker-end="url(#orange-arrow)"/>
  <text x="648" y="248" text-anchor="middle" font-size="8" fill="#9b59b6">req 2,4,6...</text>

  <!-- App1 -->
  <rect x="660" y="140" width="104" height="80" fill="#d4edda" rx="8" stroke="#4caf50" stroke-width="1.5"/>
  <text x="712" y="158" text-anchor="middle" font-size="10" font-weight="bold" fill="#1a7a3c">ğŸ–¥ï¸ Server 1</text>
  <text x="712" y="173" text-anchor="middle" font-size="9" fill="#555">CPU</text>
  <rect x="670" y="177" width="84" height="10" fill="#e0e0e0" rx="3"/>
  <rect x="670" y="177" width="46" height="10" fill="#4caf50" rx="3"/>
  <text x="712" y="202" text-anchor="middle" font-size="9" fill="#1a7a3c">~55% ğŸŸ¢</text>

  <!-- App2 -->
  <rect x="660" y="234" width="104" height="80" fill="#d4edda" rx="8" stroke="#4caf50" stroke-width="1.5"/>
  <text x="712" y="252" text-anchor="middle" font-size="10" font-weight="bold" fill="#1a7a3c">ğŸ–¥ï¸ Server 2</text>
  <text x="712" y="267" text-anchor="middle" font-size="9" fill="#555">CPU</text>
  <rect x="670" y="271" width="84" height="10" fill="#e0e0e0" rx="3"/>
  <rect x="670" y="271" width="48" height="10" fill="#4caf50" rx="3"/>
  <text x="712" y="296" text-anchor="middle" font-size="9" fill="#1a7a3c">~55% ğŸŸ¢</text>

  <!-- Both to DB -->
  <line x1="764" y1="182" x2="782" y2="218" stroke="#4caf50" stroke-width="1.2" marker-end="url(#green-arrow)"/>
  <line x1="764" y1="272" x2="782" y2="258" stroke="#4caf50" stroke-width="1.2" marker-end="url(#green-arrow)"/>

  <!-- DB after -->
  <rect x="756" y="218" width="12" height="40" fill="#d4edda" stroke="#4caf50" stroke-width="1"/>

  <!-- Result label after -->
  <rect x="444" y="322" width="322" height="62" fill="#8fd6a8" rx="6"/>
  <text x="605" y="340" text-anchor="middle" font-size="11" font-weight="bold" fill="#1a7a3c">Two machines. Two CPUs. Double the capacity.</text>
  <text x="605" y="357" text-anchor="middle" font-size="10" fill="#1a7a3c">Each server handles half the requests.</text>
  <text x="605" y="372" text-anchor="middle" font-size="10" fill="#1a7a3c">p99 latency drops. Throughput roughly doubles.</text>

  <!-- Bottom bar -->
  <rect x="20" y="414" width="760" height="36" fill="#e8f4fd" rx="6"/>
  <text x="400" y="430" text-anchor="middle" font-size="11" fill="#1a5276">The app code is identical on both servers. No code changed â€” only the infrastructure.</text>
  <text x="400" y="446" text-anchor="middle" font-size="11" fill="#1a5276">This only works because the servers are stateless. Each request is self-contained.</text>

</svg>
